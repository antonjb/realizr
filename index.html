<html>
    <head>
        <title>Realizr</title>

        <!-- tr '\n' '' < from > to -->

        <!-- jQuery adn plugins -->
        <script src="scripts/lib/jquery.js"></script>
        <!--script src="scripts/lib/serializeobject.js"></script>
        <script src="scripts/lib/charcount.js"></script>
        <script src="scripts/lib/jquery.countdown.js"></script>
        <script src="scripts/lib/jquery.prettydate.js"></script-->

        <!-- Core JS MVC -->
        <script src="node_modules/dustjs-linkedin/dist/dust-core-1.0.0.js"></script>
        <script src="node_modules/underscore/underscore.js"></script>
        <script src="node_modules/backbone/backbone.js"></script>
        <script src="node_modules/backbone/examples/backbone-localstorage.js"></script>

        <!-- Router, views, models and collections -->
        <script src="scripts/app.js" type="text/javascript"></script>
        <script src="scripts/router.js" type="text/javascript"></script>

        <script src="scripts/models/dream.js" type="text/javascript"></script>
        <script src="scripts/models/product.js" type="text/javascript"></script>
        <script src="scripts/models/user.js" type="text/javascript"></script>
        <script src="scripts/models/comment.js" type="text/javascript"></script>

        <script src="scripts/collections/dreams.js" type="text/javascript"></script>
        <script src="scripts/collections/products.js" type="text/javascript"></script>
        <script src="scripts/collections/users.js" type="text/javascript"></script>
        <script src="scripts/collections/comments.js" type="text/javascript"></script>
        <script src="scripts/collections/friends.js" type="text/javascript"></script>

        <script src="scripts/views/app.js" type="text/javascript"></script>
        <script src="scripts/views/list-item.js" type="text/javascript"></script>
        <script src="scripts/views/profile.js" type="text/javascript"></script>

        <script type="text/javascript">
        jQuery(function ($) {
            // Compile the templates - accessible via 'id' attribute of script at bottom of index.html
            $('.dust-templates').each(function () {
                var compiled = dust.compile($(this).html, $(this).attr('id'));
                dust.loadSource(compiled);
            });

            // Set up the router
            window.router = new Router();
            window.users = new UsersCollection();
            window.products = new ProductsCollection();
            window.dreams = new DreamsCollection();

            users.fetch();
            products.fetch();
            dreams.fetch();

            // Set up application
            users.fetch({success: function () {
                console.log(users.length);
                window.app = new AppView({
                    model: window.users.at(0)
                });
                app.render();
                Backbone.history.start();
            }});
        });
        </script>
    </head>
    <body>

        <!-- Dust.js templates -->
        <script id="app-template" class="dust-template" type="text/x-dust-template">
        <div id="dreams-todos" class="list"></div>
        <div id="dreams-completes" class="list"></div>
        <div id="profile"></div>
        </script>

        <script id="right-section" class="dust-template" type="text/x-dust-template">
        <div class="friends">
            {#friends}
            <div class="friend"></div>{~n}
            {/friends}
        </div>
        <div class="products"></div>
        <div class="timer"></div>
        <div class="done"></div>
        </script>

        <script id="list-item-template" class="dust-template" type="text/x-dust-template">
        <div class="list-item">
            <div class="left-section">
                <div class="main-image"></div>
                <h1 class="title">{title}</h1>
            </div>
            <div class="right-section">
                <div class="products">
                    {#products}
                    <div class="friend"></div>{~n}
                    {/products}
                </div>
                <div class="timer">{}</div>
            </div>
        </div>
        </script>

        <script id="add-item-template" class="dust-template" type="text/x-dust-template">
        <div class="add-item">
        </div>
        </script>

    </body>
</html>
